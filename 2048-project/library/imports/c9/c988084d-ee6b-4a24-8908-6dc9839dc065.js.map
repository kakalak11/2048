{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\gameBoard.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","tilePrefab","Prefab","tilesRows","Node","_onKeyDown","event","keyCode","macro","KEY","right","_moveRight","left","_moveLeft","down","_moveDown","node","children","forEach","numbers","element","filter","active","zeros","newArray","concat","removeAllChildren","addChild","shift","index","runAction","moveTo","log","i","setParent","_setupGrid","numberIndex","tile","instantiate","Math","random","setPosition","v2","getComponent","setNumber","name","_generateRandomValue","randomTile","parseInt","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","start","update","dt"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAMA,UAAUC,QAAQ,OAAR,CAAhB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAYL,GAAGM,MADP;AAERC,mBAAW,CAACP,GAAGQ,IAAJ;AAFH,KAHP;;AAQL;;AAEAC,gBAAY,oBAAUC,KAAV,EAAiB;AACzB,gBAAQA,MAAMC,OAAd;AACI,iBAAKX,GAAGY,KAAH,CAASC,GAAT,CAAaC,KAAlB;AACI,qBAAKC,UAAL;AACA;AACJ,iBAAKf,GAAGY,KAAH,CAASC,GAAT,CAAaG,IAAlB;AACI,qBAAKC,SAAL;AACA;AACJ,iBAAKjB,GAAGY,KAAH,CAASC,GAAT,CAAaK,IAAlB;AACI,qBAAKC,SAAL;AACA;AATR;AAWH,KAtBI;;AAwBLJ,gBAAY,sBAAY;AACpB,aAAKK,IAAL,CAAUC,QAAV,CAAmBC,OAAnB,CAA2B,mBAAW;AAClC,gBAAIC,UAAUC,QAAQH,QAAR,CAAiBI,MAAjB,CAAwB;AAAA,uBAAWD,QAAQE,MAAnB;AAAA,aAAxB,CAAd;AACA,gBAAIC,QAAQH,QAAQH,QAAR,CAAiBI,MAAjB,CAAwB;AAAA,uBAAW,CAACD,QAAQE,MAApB;AAAA,aAAxB,CAAZ;AACA,gBAAIE,WAAWD,MAAME,MAAN,CAAaN,OAAb,CAAf;AACAC,oBAAQM,iBAAR,CAA0B,IAA1B;AACAN,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQH,QAAR,CAAiBC,OAAjB,CAAyB,UAACE,OAAD,EAAUS,KAAV;AAAA,uBAAoBT,QAAQU,SAAR,CAAkBlC,GAAGmC,MAAH,CAAU,IAAV,EAAgB,CAAC,KAAD,GAAS,MAAMF,KAA/B,EAAsC,CAAtC,CAAlB,CAApB;AAAA,aAAzB;AACAjC,eAAGoC,GAAH,CAAOZ,QAAQH,QAAf;AACH,SAXD,EAWG,KAAKhB,UAXR;AAYH,KArCI;;AAuCLY,eAAW,qBAAY;AACnB,aAAKG,IAAL,CAAUC,QAAV,CAAmBC,OAAnB,CAA2B,mBAAW;AAClC,gBAAIC,UAAUC,QAAQH,QAAR,CAAiBI,MAAjB,CAAwB;AAAA,uBAAWD,QAAQE,MAAnB;AAAA,aAAxB,CAAd;AACA,gBAAIC,QAAQH,QAAQH,QAAR,CAAiBI,MAAjB,CAAwB;AAAA,uBAAW,CAACD,QAAQE,MAApB;AAAA,aAAxB,CAAZ;AACA,gBAAIE,WAAWL,QAAQM,MAAR,CAAeF,KAAf,CAAf;AACAH,oBAAQM,iBAAR,CAA0B,IAA1B;AACAN,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQO,QAAR,CAAiBH,SAASI,KAAT,EAAjB;AACAR,oBAAQH,QAAR,CAAiBC,OAAjB,CAAyB,UAACE,OAAD,EAAUS,KAAV;AAAA,uBAAoBT,QAAQU,SAAR,CAAkBlC,GAAGmC,MAAH,CAAU,IAAV,EAAgB,CAAC,KAAD,GAAS,MAAMF,KAA/B,EAAsC,CAAtC,CAAlB,CAApB;AAAA,aAAzB;AACAjC,eAAGoC,GAAH,CAAOZ,QAAQH,QAAf;AACH,SAXD,EAWG,KAAKhB,UAXR;AAYH,KApDI;;AAsDLc,eAAW,qBAAY;AACnB,aAAKC,IAAL,CAAUC,QAAV,CAAmBC,OAAnB,CAA2B,UAACE,OAAD,EAAUS,KAAV,EAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,SAhBD;AAiBA,aAAK,IAAII,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,iBAAKjB,IAAL,CAAUC,QAAV,CAAmBgB,CAAnB,EAAsBhB,QAAtB,CAA+B,CAA/B,EAAkCiB,SAAlC,CAA4C,KAAKlB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,CAA5C;AACA,iBAAKD,IAAL,CAAUC,QAAV,CAAmBgB,CAAnB,EAAsBhB,QAAtB,CAA+B,CAA/B,EAAkCiB,SAAlC,CAA4C,KAAKlB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,CAA5C;AACA,iBAAKD,IAAL,CAAUC,QAAV,CAAmBgB,CAAnB,EAAsBhB,QAAtB,CAA+B,CAA/B,EAAkCiB,SAAlC,CAA4C,KAAKlB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,CAA5C;AACA,iBAAKD,IAAL,CAAUC,QAAV,CAAmBgB,CAAnB,EAAsBhB,QAAtB,CAA+B,CAA/B,EAAkCiB,SAAlC,CAA4C,KAAKlB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,CAA5C;AACH;AACDrB,WAAGoC,GAAH,CAAO,KAAKhB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,EAAsBA,QAA7B;AACA,aAAKD,IAAL,CAAUC,QAAV,CAAmB,CAAnB,EAAsBA,QAAtB,CAA+B,CAA/B,IAAoC,KAAKD,IAAL,CAAUC,QAAV,CAAmB,CAAnB,EAAsBA,QAAtB,CAA+B,EAA/B,CAApC;AACArB,WAAGoC,GAAH,CAAO,KAAKhB,IAAL,CAAUC,QAAV,CAAmB,CAAnB,EAAsBA,QAA7B;AACH,KAjFI;;AAmFLkB,cAnFK,wBAmFQ;AAAA;;AACT,YAAIC,cAAc,CAAlB;AACA,aAAKpB,IAAL,CAAUC,QAAV,CAAmBC,OAAnB,CAA2B,UAACE,OAAD,EAAUS,KAAV,EAAoB;AAC3C,iBAAK,IAAII,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,oBAAII,OAAOzC,GAAG0C,WAAH,CAAe,MAAKrC,UAApB,CAAX;AACAoC,qBAAKf,MAAL,GAAciB,KAAKC,MAAL,KAAgB,GAAhB,GAAsB,IAAtB,GAA6B,KAA3C;AACAH,qBAAKI,WAAL,CAAiB7C,GAAG8C,EAAH,CAAO,CAAC,GAAD,GAAO,CAAP,GAAW,EAAZ,GAAkB,MAAMT,CAA9B,EAAiC,CAAjC,CAAjB;AACAI,qBAAKM,YAAL,CAAkB,aAAlB,EAAiCC,SAAjC,CAA2CR,WAA3C;AACAC,qBAAKQ,IAAL,aAAoBT,aAApB;AACAhB,wBAAQO,QAAR,CAAiBU,IAAjB;AACH;AACJ,SATD;AAUA;AACH,KAhGI;AAkGLS,wBAlGK,kCAkGkB;AACnB,YAAIC,aAAa,KAAK/B,IAAL,CAAUC,QAAV,CAAmB+B,SAAST,KAAKC,MAAL,KAAgB,CAAzB,CAAnB,EAAgDvB,QAAhD,CAAyD+B,SAAST,KAAKC,MAAL,KAAgB,CAAzB,CAAzD,CAAjB;AACA5C,WAAGoC,GAAH,CAAOe,UAAP;AACH,KArGI;AAuGLE,UAvGK,oBAuGI;AACLrD,WAAGsD,WAAH,CAAeC,EAAf,CAAkBvD,GAAGwD,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAqD,KAAKjD,UAA1D,EAAsE,IAAtE;AACH,KAzGI;AA2GLkD,SA3GK,mBA2GG;AACJ,aAAKpB,UAAL;AACH,KA7GI;AA+GLqB,UA/GK,kBA+GEC,EA/GF,EA+GM,CAAG;AA/GT,CAAT","file":"gameBoard.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst Emitter = require('event');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        tilePrefab: cc.Prefab,\r\n        tilesRows: [cc.Node],\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    _onKeyDown: function (event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.right:\r\n                this._moveRight();\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this._moveLeft();\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this._moveDown();\r\n                break;\r\n        }\r\n    },\r\n\r\n    _moveRight: function () {\r\n        this.node.children.forEach(element => {\r\n            let numbers = element.children.filter(element => element.active);\r\n            let zeros = element.children.filter(element => !element.active);\r\n            let newArray = zeros.concat(numbers);\r\n            element.removeAllChildren(true);\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.children.forEach((element, index) => element.runAction(cc.moveTo(0.25, -157.5 + 105 * index, 0)));\r\n            cc.log(element.children);\r\n        }, this.tilePrefab);\r\n    },\r\n\r\n    _moveLeft: function () {\r\n        this.node.children.forEach(element => {\r\n            let numbers = element.children.filter(element => element.active);\r\n            let zeros = element.children.filter(element => !element.active);\r\n            let newArray = numbers.concat(zeros);\r\n            element.removeAllChildren(true);\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.addChild(newArray.shift());\r\n            element.children.forEach((element, index) => element.runAction(cc.moveTo(0.25, -157.5 + 105 * index, 0)));\r\n            cc.log(element.children);\r\n        }, this.tilePrefab)\r\n    },\r\n\r\n    _moveDown: function () {\r\n        this.node.children.forEach((element, index) => {\r\n            // let collum = [];\r\n            // for (let i = 0; i < 4; i++) {\r\n            //     collum.push(this.node.children[i].children[index]);\r\n            //     cc.log(this.node.children[i].children[index]);\r\n            // }\r\n            // // cc.log(collum);\r\n            // let numbers = collum.filter(element => element.active);\r\n            // let zeros = collum.filter(element => !element.active);\r\n            // let newArray = zeros.concat(numbers);\r\n            // // cc.log(newArray);\r\n            // for (let i = 0; i < 4; i++) {\r\n            //     // this.node.removeChild(this.node.children[i].children[index]);\r\n            //     newArray[i].setParent(this.node.children[i]);\r\n            // }\r\n            // cc.log(this.node.children)\r\n        });\r\n        for (let i = 1; i < 4; i++) {\r\n            this.node.children[i].children[0].setParent(this.node.children[0]);\r\n            this.node.children[i].children[0].setParent(this.node.children[0]);\r\n            this.node.children[i].children[0].setParent(this.node.children[0]);\r\n            this.node.children[i].children[0].setParent(this.node.children[0]);\r\n        }\r\n        cc.log(this.node.children[0].children);\r\n        this.node.children[0].children[0] = this.node.children[0].children[15];\r\n        cc.log(this.node.children[0].children);\r\n    },\r\n\r\n    _setupGrid() {\r\n        let numberIndex = 1;\r\n        this.node.children.forEach((element, index) => {\r\n            for (let i = 0; i < 4; i++) {\r\n                let tile = cc.instantiate(this.tilePrefab);\r\n                tile.active = Math.random() > 0.7 ? true : false;\r\n                tile.setPosition(cc.v2((-415 / 2 + 50) + 105 * i, 0));\r\n                tile.getComponent('tilesScript').setNumber(numberIndex);\r\n                tile.name = `tiles${numberIndex++}`;\r\n                element.addChild(tile);\r\n            }\r\n        });\r\n        // cc.log(this.node.children.forEach(element => element.children.forEach(element => cc.log(element))));\r\n    },\r\n\r\n    _generateRandomValue() {\r\n        let randomTile = this.node.children[parseInt(Math.random() * 3)].children[parseInt(Math.random() * 3)];\r\n        cc.log(randomTile);\r\n    },\r\n\r\n    onLoad() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this._onKeyDown, this);\r\n    },\r\n\r\n    start() {\r\n        this._setupGrid();\r\n    },\r\n\r\n    update(dt) { },\r\n});\r\n"]}