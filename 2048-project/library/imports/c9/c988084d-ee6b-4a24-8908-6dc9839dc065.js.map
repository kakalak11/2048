{"version":3,"sources":["../../../../assets/script/assets/script/gameBoard.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","tilePrefab","Prefab","_tilesMatrix","_moving","_onKeyDown","event","keyCode","macro","KEY","right","node","emit","left","_moveLeft","down","_moveDown","up","_moveUp","space","_generateRandomValue","c","v","_moveRight","forEach","element","rowIndex","numbers","filter","active","zeros","concat","collumnIndex","runAction","sequence","moveTo","callFunc","i","shift","collumn","j","push","_combineHorizon","directionRight","log","index","array","skip","nextElement","elementScript","getComponent","nextElementScript","number","setNumber","reverse","_combineVertical","randomCollumn","Math","floor","random","randomRow","every","randomTile","scale","setPosition","v2","scaleTo","_setupGrid","numberIndex","row","tile","instantiate","name","Number","String","getPosition","y","x","addChild","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","_combineTile","start","update","dt"],"mappings":"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","file":"gameBoard.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst Emitter = require('event');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tilePrefab: cc.Prefab,\n        _tilesMatrix: [],\n        _moving: null,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    _onKeyDown: function (event) {\n        if (this._moving) return;\n        switch (event.keyCode) {\n            case cc.macro.KEY.right:\n                this._moving = true;\n                this.node.emit('right')\n                break;\n            case cc.macro.KEY.left:\n                this._moving = true;\n                this._moveLeft();\n                break;\n            case cc.macro.KEY.down:\n                this._moving = true;\n                this._moveDown();\n                break;\n            case cc.macro.KEY.up:\n                this._moving = true;\n                this._moveUp();\n                break;\n            case cc.macro.KEY.space:\n                this._generateRandomValue();\n                break;\n            case cc.macro.KEY.c:\n                this.node.emit('combine', true);\n                break;\n            case cc.macro.KEY.v:\n                this.node.emit('combine', false);\n                break;\n        }\n    },\n\n    _moveRight: function () {\n        this._tilesMatrix.forEach((element, rowIndex) => {\n            let numbers = element.filter(element => element.active);\n            let zeros = element.filter(element => !element.active);\n            element = zeros.concat(numbers);\n            element.forEach((element, collumnIndex) => element.runAction(cc.sequence(cc.moveTo(0.25, -157.5 + 105 * collumnIndex, 157.5 - 105 * rowIndex), cc.callFunc(() => {\n                this._moving = false;\n            }))));\n            for (let i = 0; i < 4; i++) {\n                this._tilesMatrix[rowIndex][i] = element.shift();\n            }\n        });\n        this.node.emit('move');\n    },\n\n    _moveLeft: function () {\n        this._tilesMatrix.forEach((element, rowIndex) => {\n            let numbers = element.filter(element => element.active);\n            let zeros = element.filter(element => !element.active);\n            element = numbers.concat(zeros);\n            element.forEach((element, collumnIndex) => element.runAction(cc.sequence(cc.moveTo(0.25, -157.5 + 105 * collumnIndex, 157.5 - 105 * rowIndex), cc.callFunc(() => {\n                this._moving = false;\n            }))));\n            for (let i = 0; i < 4; i++) {\n                this._tilesMatrix[rowIndex][i] = element.shift();\n            }\n        });\n        this.node.emit('move');\n    },\n\n    _moveDown: function () {\n        for (let i = 0; i < 4; i++) {\n            let collumn = [];\n            for (let j = 0; j < 4; j++) {\n                collumn.push(this._tilesMatrix[j][i]);\n            }\n            let numbers = collumn.filter(element => element.active);\n            let zeros = collumn.filter(element => !element.active);\n            collumn = zeros.concat(numbers);\n            for (let j = 0; j < 4; j++) {\n                this._tilesMatrix[j][i] = collumn.shift();\n            }\n        }\n        this._tilesMatrix.forEach((element, rowIndex) => element.forEach((element, collumnIndex) => {\n            element.runAction(cc.moveTo(0.25, -157.5 + 105 * collumnIndex, 157.5 - 105 * rowIndex));\n            this._moving = false;\n        }));\n        this.node.emit('move');\n    },\n\n    _moveUp: function () {\n        for (let i = 0; i < 4; i++) {\n            let collumn = [];\n            for (let j = 0; j < 4; j++) {\n                collumn.push(this._tilesMatrix[j][i]);\n            }\n            let numbers = collumn.filter(element => element.active);\n            let zeros = collumn.filter(element => !element.active);\n            collumn = numbers.concat(zeros);\n            for (let j = 0; j < 4; j++) {\n                this._tilesMatrix[j][i] = collumn.shift();\n            }\n        }\n        this._tilesMatrix.forEach((element, rowIndex) => element.forEach((element, collumnIndex) => {\n            element.runAction(cc.moveTo(0.25, -157.5 + 105 * collumnIndex, 157.5 - 105 * rowIndex));\n            this._moving = false;\n        }));\n        this.node.emit('move');\n    },\n\n    _combineHorizon: function (directionRight) {\n        cc.log('time to combine !!!');\n        cc.log(directionRight);\n        if (directionRight) {\n            this._tilesMatrix.forEach(element => {\n                element.forEach((element, index, array) => {\n                    while (this.skip) {\n                        this.skip = false;\n                        return;\n                    }\n                    cc.log(element, this.nextElement);\n                    this.nextElement = array[index + 1];\n                    this.elementScript = element.getComponent('tilesScript');\n                    if (this.nextElement) this.nextElementScript = this.nextElement.getComponent('tilesScript');\n                    else return;\n                    cc.log(this.elementScript.number, this.nextElementScript.number);\n                    cc.log(this.elementScript.number === this.nextElementScript.number);\n                    if (this.elementScript.number === this.nextElementScript.number) {\n                        this.nextElementScript.setNumber(this.nextElementScript.number *= 2);\n                        this.elementScript.setNumber(0);\n                        element.active = false;\n                        this.skip = true;\n                    }\n                });\n            });\n            return;\n        }\n\n        this._tilesMatrix.forEach(element => {\n            element.reverse().forEach((element, index, array) => {\n                cc.log(element);\n                while (this.skip) {\n                    this.skip = false;\n                    return;\n                }\n                cc.log(element, this.nextElement);\n                this.nextElement = array[index + 1];\n                this.elementScript = element.getComponent('tilesScript');\n                if (this.nextElement) this.nextElementScript = this.nextElement.getComponent('tilesScript');\n                else return;\n                cc.log(this.elementScript.number, this.nextElementScript.number);\n                cc.log(this.elementScript.number === this.nextElementScript.number);\n                if (this.elementScript.number === this.nextElementScript.number) {\n                    this.nextElementScript.setNumber(this.nextElementScript.number *= 2);\n                    this.elementScript.setNumber(0);\n                    element.active = false;\n                    this.skip = true;\n                }\n            });\n            element.reverse();\n        });\n    },\n\n    _combineVertical: function () {\n        for (let i = 0; i < 4; i++) {\n            this.collumn = [];\n            for (let j = 0; j < 4; j++) {\n                this.collumn.push(this._tilesMatrix[i][j]);\n            }\n            this.collumn.forEach((element, index, array) => {\n\n            });\n        }\n    },\n\n    _generateRandomValue() {\n        do {\n            this.randomCollumn = Math.floor(Math.random() * 4);\n            this.randomRow = Math.floor(Math.random() * 4);\n            if (this._tilesMatrix.every(element => element.every(element => element.active))) {\n                return;\n            }\n        } while (this._tilesMatrix[this.randomRow][this.randomCollumn].active);\n        this.randomTile = this._tilesMatrix[this.randomRow][this.randomCollumn];\n        this.number = this.randomTile.getComponent('tilesScript');\n        this.randomTile.active = true;\n        this.randomTile.scale = 0;\n        this.number.setNumber(Math.random() > 0.7 ? 4 : 2);\n        this.randomTile.setPosition(cc.v2(-157.5 + 105 * this.randomCollumn, 157.5 - 105 * this.randomRow));\n        this.randomTile.runAction(cc.scaleTo(0.25, 1));\n    },\n\n    _setupGrid() {\n        let numberIndex = 1;\n        this._tilesMatrix.push([], [], [], []);\n        for (let collumn = 0; collumn < 4; collumn++) {\n            for (let row = 0; row < 4; row++) {\n                let tile = cc.instantiate(this.tilePrefab);\n                tile.active = Math.random() > 0.9 ? true : false;\n                tile.active ? tile.getComponent('tilesScript').setNumber(Math.random() > 0.5 ? 2 : 4) : tile.getComponent('tilesScript').setNumber(0);\n                tile.name = `tile ${numberIndex++}`;\n                tile.setPosition(cc.v2(-157.5 + 105 * row, 157.5 - 105 * collumn));\n                this._tilesMatrix[Number(String((tile.getPosition().y - 157.5) * -1)[0])][Number(String(tile.getPosition().x + 157.5)[0])] = tile;\n                this.node.addChild(tile);\n            }\n        }\n    },\n\n    onLoad() {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this._onKeyDown, this);\n        this._setupGrid();\n        this.node.on('move', this._generateRandomValue, this);\n        this.node.on('right', this._moveRight, this);\n        this.node.on('combine', this._combineTile, this);\n    },\n\n    start() {\n    },\n\n    update(dt) {\n\n    },\n});\n"]}