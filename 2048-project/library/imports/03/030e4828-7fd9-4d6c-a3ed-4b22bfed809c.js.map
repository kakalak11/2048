{"version":3,"sources":["../../../../assets/script/assets/script/leaderBoardScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","content","Node","itemPrefab","Prefab","userNameBox","EditBox","score","Label","_highScoreList","_data","_bestScore","_bestPlayer","_playing","onClickLeaderBoardButton","instance","emit","onClickReturn","onClickSave","value","string","push","setItem","length","log","_loadData","index","getItem","_sortData","forEach","element","array","number","parseInt","split","temp","indexOf","_updateLeaderBoard","removeAllChildren","item","instantiate","label","getComponent","addChild","_show","node","runAction","moveTo","v2","easing","easeExponentialInOut","_hide","onLoad","sys","localStorage","removeItem","registerEvent","bind","start","player"],"mappings":"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","file":"leaderBoardScript.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst Emitter = require('mEmitter');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        content: cc.Node,\n        itemPrefab: cc.Prefab,\n        userNameBox: cc.EditBox,\n        score: cc.Label,\n        _highScoreList: [],\n        _data: null,\n        _bestScore: 0,\n        _bestPlayer: '',\n        _playing: null,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onClickLeaderBoardButton: function () {\n        Emitter.instance.emit('showLeaderBoard');\n        Emitter.instance.emit('hideMenu');\n    },\n\n    onClickReturn: function () {\n        Emitter.instance.emit('hideLeaderBoard');\n        Emitter.instance.emit('showMenu');\n    },\n\n    onClickSave: function () {\n        let value = `${this.userNameBox.string} : ${this.score.string}`;\n        this._highScoreList.push(value);\n        this.userNameBox.string = '';\n        this._data.setItem(this._highScoreList.length - 1, value);\n        cc.log(this._data);\n        return;\n    },\n\n    _loadData: function () {\n        for (let index = 0; index < this._data.length; index++) {\n            if (this._data.getItem(index) === null) continue;\n            this._highScoreList.push(this._data.getItem(index));\n        }\n        // cc.log(this._highScoreList);\n        this._sortData();\n        return;\n    },\n\n    _sortData: function () {\n        this._highScoreList.forEach((element, index, array) => {\n            this.number = parseInt(element.split(':')[1]);\n            if (this._bestScore < this.number) {\n                this._bestScore = this.number;\n                this._bestPlayer = element.split(':')[0];\n                return;\n            }\n        });\n        // cc.log(`${this._bestPlayer}: ${this._bestScore}`);\n        let temp = this._highScoreList[0];\n        this._highScoreList[this._highScoreList.indexOf(`${this._bestPlayer}: ${this._bestScore}`)] = temp;\n        this._highScoreList[0] = `${this._bestPlayer}: ${this._bestScore}`;\n        // cc.log(this._highScoreList);\n        this._updateLeaderBoard();\n    },\n\n    _updateLeaderBoard: function () {\n        this.content.removeAllChildren();\n        this._highScoreList.forEach((element, index) => {\n            let item = cc.instantiate(this.itemPrefab);\n            let label = item.getComponent(cc.Label);\n            this.content.addChild(item);\n            if (index === 0) {\n                label.string = `_____UWU_____${index + 1}_____UWU_____\\n${element.split(':')[0]}\\n${element.split(':')[1]}`;\n                return;\n            }\n            label.string = `__________${index + 1}__________\\n${element.split(':')[0]}\\n${element.split(':')[1]}`;\n        })\n    },\n\n    _show: function () {\n        this.node.runAction(cc.moveTo(0.5, cc.v2(0, 0)).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    _hide: function () {\n        this.node.runAction(cc.moveTo(0.5, cc.v2(500, 0)).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    onLoad() {\n        this._data = cc.sys.localStorage;\n        this._data.removeItem('debug');\n        this._loadData();\n        Emitter.instance.registerEvent('showLeaderBoard', this._show.bind(this));\n        Emitter.instance.registerEvent('hideLeaderBoard', this._hide.bind(this));\n        Emitter.instance.registerEvent('playing', () => this._playing = true);\n        Emitter.instance.registerEvent('notPlaying', () => this._playing = false);\n    },\n\n    start() {\n        Emitter.instance.emit('notify', { player: this._bestPlayer, score: this._bestScore });\n\n    },\n\n    // update (dt) {},\n});\n"]}