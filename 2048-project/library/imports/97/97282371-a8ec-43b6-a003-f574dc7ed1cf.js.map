{"version":3,"sources":["../../../../../assets/scripts/common/assets/scripts/common/TileController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/scripts/common","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass('TileController')\nexport default class TileController extends cc.Component {\n\n    @property(cc.Integer)\n    timeMove: number = 1;\n\n    @property(cc.Integer)\n    distanceMove: number = 100;\n\n    directionList: cc.Vec2[] = [];\n    isInvokable: boolean = true;\n    isIdle: boolean = null;\n\n    onLoad() {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n\n        this.schedule(this.executeNextMove, 1);\n    };\n\n    onKeyDown(event) {\n\n    };\n\n    onKeyUp(event) {\n        let direction: cc.Vec2 = null;\n        switch (event.keyCode) {\n            case cc.macro.KEY.d:\n                direction = cc.Vec2.RIGHT;\n                break;\n            case cc.macro.KEY.a:\n                direction = cc.Vec2.RIGHT.mul(-1);\n                break;\n            case cc.macro.KEY.w:\n                direction = cc.Vec2.UP;\n                break;\n            case cc.macro.KEY.s:\n                direction = cc.Vec2.UP.mul(-1);\n                break;\n        };\n    };\n\n    executeNextMove(direction?) {\n        if (direction) {\n            this.directionList.push(direction)\n            return;\n        }\n        if (!this.directionList || this.directionList.length === 0) {\n            this.isIdle = true;\n            return;\n        }\n        const directionCommand = this.directionList.shift();\n        this.moveTiles(directionCommand);\n    }\n\n    moveTiles(direction: cc.Vec2) {\n        this.node.children.forEach(tile => {\n            cc.tween(tile)\n                .by(this.timeMove, direction.mul(this.distanceMove))\n                .start();\n        }, this);\n\n    }\n}\n"]}