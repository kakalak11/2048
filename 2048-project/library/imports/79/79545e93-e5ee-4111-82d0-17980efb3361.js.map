{"version":3,"sources":["../../../../assets/script/assets/script/windowScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","score","Node","bestScoreNumber","Label","gameBoard","leaderBoard","winBoard","loseBoard","_playing","onClickPlayButton","instance","emit","onClickMenuButton","_scoreUpdate","gameMatrix","getComponent","_tilesMatrix","flat","string","scoreNumber","forEach","element","number","_win","_lose","onClickReturnButton","_reset","_show","node","runAction","moveTo","easing","easeExponentialInOut","_hide","onLoad","on","leaderBoardScript","active","log","_bestScore","registerEvent","bind","start"],"mappings":"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","file":"windowScript.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst Emitter = require('mEmitter');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        score: cc.Node,\n        bestScoreNumber: cc.Label,\n        gameBoard: cc.Node,\n        leaderBoard: cc.Node,\n        winBoard: cc.Node,\n        loseBoard: cc.Node,\n        _playing: false,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onClickPlayButton: function () {\n        Emitter.instance.emit('showWindow');\n        if (!this._playing) {\n            Emitter.instance.emit('start');\n        }\n        Emitter.instance.emit('canMove');\n        Emitter.instance.emit('playing');\n    },\n\n    onClickMenuButton: function () {\n        Emitter.instance.emit('hideWindow');\n    },\n\n    _scoreUpdate: function () {\n        this.gameMatrix = this.gameBoard.getComponent('gameBoard')._tilesMatrix.flat();\n        if (!this.gameMatrix) {\n            this.score.getComponent('cc.Label').string = 0;\n            return;\n        }\n        this.scoreNumber = 0;\n        this.gameMatrix.forEach(element => this.scoreNumber += element.getComponent('tilesScript').number);\n        this.score.getComponent('cc.Label').string = this.scoreNumber;\n        return;\n    },\n\n    _win: function () {\n        this.winBoard.emit('winBoard');\n        Emitter.instance.emit('notPlaying');\n    },\n\n    _lose: function () {\n        this.loseBoard.emit('loseBoard');\n        Emitter.instance.emit('notPlaying');\n    },\n\n    onClickReturnButton: function () {\n        this.gameBoard.getComponent('gameBoard')._reset();\n        if (this._playing) Emitter.instance.emit('notPlaying');\n        Emitter.instance.emit('start');\n        Emitter.instance.emit('canMove');\n        Emitter.instance.emit('playing');\n        return;\n    },\n\n    _show: function () {\n        this.node.runAction(cc.moveTo(0.5, 0, 0).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    _hide: function () {\n        this.node.runAction(cc.moveTo(0.5, -500, 0).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    onLoad() {\n        this.node.on('updateScore', this._scoreUpdate, this);\n        this.node.on('win', this._win, this);\n        this.node.on('lose', this._lose, this);\n        this.leaderBoardScript = this.leaderBoard.getComponent('leaderBoardScript');\n        this.leaderBoardScript.active = false;\n        cc.log(this.leaderBoardScript._bestScore);\n        this.bestScoreNumber.string = this.leaderBoardScript._bestScore;\n\n        Emitter.instance.registerEvent('showWindow', this._show.bind(this));\n        Emitter.instance.registerEvent('hideWindow', this._hide.bind(this));\n        Emitter.instance.registerEvent('playing', () => this._playing = true);\n        Emitter.instance.registerEvent('notPlaying', () => this._playing = false);\n\n    },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});\n"]}