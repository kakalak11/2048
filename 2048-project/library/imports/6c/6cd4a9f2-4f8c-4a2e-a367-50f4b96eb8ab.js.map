{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scenes\\testScript/assets\\scenes\\testScript\\prefabScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","nodeSprite","Node","nodeLabel","Label","_pos","Vec2","_index","_time","_moving","number","_setPosition","start","node","setPosition","opacity","once","dispatchEvent","Event","EventCustom","log","action","sequence","moveTo","v2","callFunc","runAction","_setActive","data","Math","random","string","scaleTo","setNumber","_getCombine","key","_setCombine","pos","onLoad","instance","registerEvent","bind"],"mappings":"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","file":"prefabScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scenes\\testScript","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst Emitter = require('mEmitter');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        nodeSprite: cc.Node,\r\n        nodeLabel: cc.Label,\r\n        _pos: cc.Vec2,\r\n        _index: null,\r\n        _time: 0.25,\r\n        _moving: null,\r\n        number: 0,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    _setPosition: function (start) {\r\n        if (this._moving) return;\r\n        if (start) {\r\n            this.node.setPosition(this._pos);\r\n            return;\r\n        }\r\n        if (this.node.opacity === 0) {\r\n            this.node.setPosition(this._pos);\r\n            return;\r\n        }\r\n        this.node.once('position-changed', () => {\r\n            this.node.dispatchEvent(new cc.Event.EventCustom('moved', true));\r\n            cc.log('pos change');\r\n        }, this);\r\n        this._moving = true;\r\n        this.action = cc.sequence(\r\n            cc.moveTo(this._time, cc.v2(this._pos)),\r\n            cc.callFunc(() => {\r\n                this._moving = false;\r\n                this.node.dispatchEvent(new cc.Event.EventCustom('canMove', true));\r\n                this.node.dispatchEvent(new cc.Event.EventCustom('stop', true));\r\n            })\r\n        );\r\n        this.node.runAction(this.action);\r\n        return;\r\n    },\r\n\r\n    _setActive: function (data = null) {\r\n        if (data !== this._index || this.node.opacity !== 0) return;\r\n        this.node.opacity = 255;\r\n        this.number = Math.random() > 0.5 ? 2 : 4;\r\n        this.nodeLabel.string = this.number;\r\n        let action = cc.sequence(\r\n            cc.scaleTo(this._time / 2, 1.2),\r\n            cc.callFunc(() => {\r\n            }),\r\n            cc.scaleTo(this._time / 2, 1),\r\n        );\r\n        this.node.runAction(action);\r\n        return;\r\n    },\r\n\r\n    setNumber: function (number) {\r\n        this.number = number;\r\n        this.nodeLabel.string = this.number;\r\n        return;\r\n    },\r\n\r\n    _getCombine: function (data) {\r\n        if (data.key !== this._index) return;\r\n        // cc.log('this is the one get combine', data.key);\r\n        this.number *= 2;\r\n        this.nodeLabel.string = this.number;\r\n        let action = cc.sequence(\r\n            cc.scaleTo(this._time / 2, 1.2),\r\n            cc.callFunc(() => {\r\n            }),\r\n            cc.scaleTo(this._time / 2, 1),\r\n        );\r\n        this.node.runAction(action);\r\n        return;\r\n    },\r\n\r\n    _setCombine: function (data) {\r\n        if (data.key !== this._index) return;\r\n        this.number = 0;\r\n        this.node.opacity = 0;\r\n        this.nodeLabel.string = this.number;\r\n        let action = cc.sequence(\r\n            cc.moveTo(this._time, data.pos),\r\n            cc.callFunc(() => {\r\n                this.node.setPosition(this._pos);\r\n            }),\r\n        );\r\n        this.node.runAction(action);\r\n        return;\r\n    },\r\n\r\n    onLoad() {\r\n        Emitter.instance.registerEvent('setPosition', this._setPosition.bind(this));\r\n        Emitter.instance.registerEvent('setActive', this._setActive.bind(this));\r\n\r\n        Emitter.instance.registerEvent('getCombine', this._getCombine.bind(this));\r\n        Emitter.instance.registerEvent('setCombine', this._setCombine.bind(this));\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    // update(dt) {},\r\n});\r\n"]}